---
title: "Analýza krízy Covid-19 na znečistenie ovzdušia v Indií"
author: "Marek Holik"
format: html
code-fold: true
---

## Hypotéza

Na úlohu analyzovania dát som si vybral dva datasety. Prvý obsahuje hodnoty z meraní kvality ovzdušia v Indií od roku 2017 až to roku 2022, ako druhý dataset som si vybral rast počtu prípadov ochorenia Covid 19, ktorý začal v roku 2020 a obsahuje dáta do roku 2022. Predpokladal som, že počas krízy by malo dosť k výraznému poklesu znečistenia ovzdušia v tejto krajine. Pozrime sa teda, či je moja hypotéza pravdivá alebo nie.

```{r, echo=FALSE}
suppressWarnings({
suppressMessages(library(readxl))
suppressMessages(library(tidyr))
suppressMessages(library(tidyverse))
suppressMessages(library(dplyr))
suppressMessages(library(stringr))})

covid <- read.csv("C:\\Users\\mares\\Desktop\\CODES\\R\\zadanie_8\\Covid 19 Confirmed Cases-Kerala.csv")
covid <- separate(covid, Date, c("Year", "Month", "Day"))

air_quality <- read.csv("C:\\Users\\mares\\Desktop\\CODES\\R\\zadanie_8\\air-quality-india.csv") %>% 
    group_by(Year, Month, Day) %>%
    summarise(priemer = round(mean(PM2.5)), .groups = "keep")
air_quality$Timestamp <- as.Date(with(air_quality, paste(Year, Month, Day,sep="-")), "%Y-%m-%d")
air_quality$Day <- str_pad(air_quality$Day, 2, pad = "0")
air_quality$Month <- str_pad(air_quality$Month, 2, pad= "0")
covid$Timestamp <- as.Date(with(covid, paste(Year, Month, Day, sep="-")), "%Y-%m-%d")

```

## Znečistenie ovzdušia v Indii

Na začiatok som si vykreslil graf, ktorý reprezentuje namerané hodnoty počas 5 rokov merania. Môžeme si všimnúť, že počas letných mesiacov výrazne poklesne znečistenie a výskyt PM2.5 - čo sú častice menšie ako 0.025mm. Na prvý pohľad vidíme, že graf klesá, čiže výskyt týchto častíc klesá. Pomocou vstavanej funkcie v R sme si vedeli vytvoriť model, ktorý nám hovorí o hodnotách v grafe, že klesajú.

```{r}
mod1 = lm(priemer ~ Timestamp, data = air_quality)

grid <- air_quality %>%
    modelr::data_grid(Timestamp, priemer) %>%
    modelr::add_predictions(mod1)

plot(air_quality$Timestamp, air_quality$priemer, type="h", xlab="", ylab="",col = "blue")
par(new=TRUE)
plot(grid$Timestamp, grid$pred, type="l", xlab="", ylab="", yaxt = "n", col = "darkgreen")
axis(side=4)
legend("topright", legend=c("Hodnota PM2.5", "trend"), col=c("blue", "darkgreen"), lty=1)
```

## Prípady ochorenia Covid-19 v Indii

V ďalšom kroku analýzy sme si vypísali graf pre vývoj počtu potvrdených prípadov covid-19 a taktiež môžeme vidieť, že časom množstvo výskytov rástlo, no na konci roku 2022 sa rast zastavil, resp. množstvo denných potvrdených prípadov prudko klesol.

```{r}
mod = lm(Confirmed ~ Timestamp, data = covid)

grid1 <- covid %>%
    modelr::data_grid(Timestamp, Confirmed) %>%
    modelr::add_predictions(mod)

plot(covid$Timestamp, covid$Confirmed, type="h", xlab="", ylab="",col = "orange")
par(new=TRUE)
plot(grid1$Timestamp, grid1$pred, type="l", xlab="", ylab="", yaxt = "n", col = "blue")
axis(side=4)
legend("topleft", legend=c("Covid cases", "prediction"), col=c("orange","blue"), lty=1)
```

## Analýza dopadu krízy na ovzdušie

Pri pozorovaní grafov vidíme, že za následok zvýšeného počtu výskytu prípadov sa znižuje množstvo PM2.5 čatíc v ovzduší. Keďže analyzujeme dataset, ktorý obsahuje iba hodnoty za obdobie posledných 3-5 rokov, nevieme s istotou určiť, či kríza má ten najvýznamnejší dopad na ovzdušie v Indií. Taktiež vieme, že India nebola jedna z krajín, ktorá by podnikla rýchle a urgentné opatrenia proti šíreniu vírusu.

```{r, echo=FALSE}
suppressMessages(suppressWarnings(library(plotly)))
suppressMessages(suppressWarnings(library(patchwork)))

dat <- merge(covid, air_quality, all= TRUE) 
dat$Timestamp <- as.Date(with(dat, paste(Year, Month, Day,sep="-")), "%Y-%m-%d")
dat <- select(dat, c(Timestamp, Confirmed, priemer))

plot(dat$Timestamp, dat$priemer, type="l", col="lightblue", xlab="", ylab="", lwd=2)
par(new=TRUE)
plot(dat$Timestamp, dat$Confirmed, type="l", col="orange", yaxt = "n",xlab="Timestamp", ylab="Cases", lwd=2)
par(new=TRUE)
plot(grid1$Timestamp, grid1$pred, type="l", xlab="", ylab="", yaxt = "n",xaxt = "n", col = "blue")
par(new=TRUE)
plot(grid$Timestamp, grid$pred, type="l", xlab="", ylab="", yaxt = "n", col = "darkgreen")
axis(side=4)
title("Correlation between cases and polution")

legend("top", legend=c("Polution in India", "Confirmed cases"), col=c("lightblue", "orange"), lty=1)
```

## Záver 
Z tabuľky si môžeme všimnúť, že najmenšie namerané hodnoty PM2.5 v ovzduší boli 13.00, pričom najvyššie boli až 120.00 Pm2.5. Taktiež si vieme všimnúť, že stredná hodnota nameraných hodnôt je okolo 48.00 PM2.5, čo je veľmi nebezpečné. viď obrázok:

```{r}
summary(dat$priemer)
knitr::include_graphics("C:\\Users\\mares\\Desktop\\CODES\\R\\zadanie_8\\PM.png")

```

Hypotézu sme z časti potvrdili, čiže kríza mala kladný vplyv na celkové znečistenie ovzdušia v Indií. 